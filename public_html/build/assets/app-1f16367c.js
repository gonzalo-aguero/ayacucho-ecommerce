var S=Object.defineProperty;var A=(n,t,e)=>t in n?S(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var f=(n,t,e)=>(A(n,typeof t!="symbol"?t+"":t,e),e);class I{constructor(){f(this,"content");this.content=[],this.load()}add(t,e=1){e=parseInt(e);const r=Alpine.store("products").findIndex(u=>u.id===t.id),i=this.content.findIndex(u=>u.pos===r);return i!==-1?this.content[i].units+=e:this.content.push({pos:r,units:e}),this.save(),!0}get content(){return this.content}remove(t){let e=!1;const r=this.content.findIndex(i=>i.pos===t.pos);return r!==-1&&(this.content.splice(r,1),this.save(),e=!0),e}clear(){this.content=[],this.save()}save(){const r=new Date(new Date().getTime()+18144e5).toUTCString();document.cookie=`cart=${JSON.stringify(this.content)}; expires=date-in-GMTString-format=${r};`}load(){if(document.cookie.split(";").some(e=>e.includes("cart"))){const e=document.cookie.split(";").find(i=>i.startsWith("cart=")).slice(5);let r=JSON.parse(e);r=r.map(i=>({pos:i.pos,units:parseInt(i.units)})),this.content=r}else this.save()}length(){return this.content.length}total(){let t=0;return this.content.forEach(e=>{const r=Alpine.store("products")[e.pos];t+=r.price*e.units}),t}}const E=class{constructor(t=[]){this.methods=t}get _methods(){return this.methods}set _methods(t=[]){this.methods=t}async load(){await fetch(E.api).then(t=>t.json()).then(t=>{this.methods=t})}};let m=E;f(m,"api","./json/MetodosDePago.json");class x{static squareMeters(t,e){return t>=0?(t*e.m2ByUnit).toPrecision(3):0}static productPage(t){let e="producto/"+t.name+"/"+t.id;return e=e.replace(/ /g,"-").toLowerCase(),e}static measurableInM2(t){return t.m2Price!=null&&t.m2ByUnit!=null}static addToCart({units:t},e){Alpine.store("cart").add(e,t)?(Alpine.store("Notify").Success("Agregado al carrito",1500),t=1):Alpine.store("Notify").Error("Ha ocurrido un error al agregar al carrito",2e3)}}const y=class{constructor(t=[]){this.zones=t}get _zones(){return this.zones}set _zones(t=[]){this.zones=t}async load(){await fetch(y.api).then(t=>t.json()).then(t=>{this.zones=t})}};let h=y;f(h,"api","./json/ZonasDeEnvio.json");var P;(function(n){var t={soundsOff:!1,sounds:{success:"sounds/success, warning/1.mp3",warning:"sounds/success, warning/3.mp3",error:"sounds/errors/1.mp3"},animDuration:{success:4e3,warning:4e3,error:4e3}};Object.defineProperty(n,"Settings",{get:function(){return t},set:function(c){t.sounds=c.sounds||t.sounds,t.animDuration=c.animDuration||t.animDuration,t.soundsOff=c.soundsOff!=null?c.soundsOff:t.soundsOff}});function e(c,s){s===void 0&&(s=t.animDuration.error),v("error",c,s,g("error"))}n.Error=e;function r(c,s){s===void 0&&(s=t.animDuration.success),v("success",c,s,g("success"))}n.Success=r;function i(c,s){s===void 0&&(s=t.animDuration.warning),v("warning",c,s,g("warning"))}n.Warning=i;function u(c){c.classList.remove("active"),c.classList.remove("success"),c.classList.remove("error"),c.addEventListener("transitionend",function(s){var d=s.currentTarget.parentNode;s.propertyName!="bottom"||d==null||(setTimeout(function(){var a=d.getElementsByClassName("component-notify").length;a===0&&d.remove()},0),s.currentTarget.remove())})}n.Close=u;function g(c){var s=document.createElement("div");s.className="component-notify";var d=document.createElement("div");d.className="--text";var a=document.createElement("div");a.className="--button-close",a.addEventListener("click",function(C){C.stopPropagation();var O=C.target.closest(".component-notify");u(O)}),a.innerHTML="<span>&#10006;</span>",s.appendChild(d),s.appendChild(a);var l=document.getElementById("notify-container");if(l||(l=document.createElement("div"),l.id="notify-container",document.body.appendChild(l)),t.soundsOff){var p=document.createElement("audio"),w=t.sounds[c];p.autoplay="autoplay",p.onended=function(){this.remove()},p.className="notify-sound",p.innerHTML='<source src="'+w+'" type="audio/mpeg" /><embed hidden="true" autostart="true" loop="false" src="'+w+'" />',l.appendChild(p)}return l.insertAdjacentElement("afterBegin",s),s}function v(c,s,d,a){s=s||"«ñîîáùåíèå íå ïåðåäàíî»",a.closest("#notify-container");var l=a.getElementsByClassName("--text")[0];l.textContent=s,setTimeout(function(){a.classList.add("active"),a.classList.add(c)},0),d&&setTimeout(function(){n.Close(a)},d)}})(P||(P={}));const T=P;DEBUG&&console.log("Code working");function o(n,t){if(t===void 0)return Alpine.store(n);Alpine.store(n,t)}document.addEventListener("alpine:init",async function(){switch(o("products",[]),o("productsLength",0),o("sortedProducts",[]),o("productsToPrint",[]),o("printedProductsMax",!1),o("cart",new I),o("StaticProduct",x),o("Notify",T),o("cartOpened",!1),o("priceFormat",M),o("Confirm",N),await B(),console.log("PRODUCTOS CARGADOS 2"),T.Settings={soundsOff:!1,animDuration:{success:5e3,warning:5e3,error:5e3}},window.location.pathname){case"/":j();break;case"/checkout":H();break}});function D(){const n=[];let t,e,r;o("products").forEach(i=>{t=i.category,e=n.findIndex(u=>u.category===t),e===-1?(r={category:t,products:[]},r.products.push(i),n.push(r)):n[e].products.push(i)}),o("sortedProducts",n)}function L(n){let t=[],e;n!==!1?o("sortedProducts").forEach(r=>{e={category:r.category,products:[]},e.products=r.products.slice(0,n),t.push(e)}):o("productsToPrint",o("sortedProducts")),DEBUG&&console.log("Products To Print:",t),o("productsToPrint",o("sortedProducts"))}async function B(){await fetch("json/Productos.json").then(n=>n.json()).then(n=>{o("products",n),o("productsLength",n.length),DEBUG&&console.log("Productos sin ordenar:",o("products")),D(),o("sortedProducts",o("sortedProducts")),DEBUG&&console.log("Productos ordenados:",o("sortedProducts")),L(o("printedProductsMax")),console.log("PRODUCTOS CARGADOS")})}function M(n){return"$"+new Intl.NumberFormat("de-DE").format(n)}function N(n){return confirm(n)}function j(){console.log("THIS IS THE HOME PAGE.")}function H(){console.log("THIS IS THE CHECKOUT PAGE."),Alpine.data("paymentMethodSelect",()=>({loaded:!1})),o("paymentMethods",new m),o("shippingZones",new h),(async()=>(await o("paymentMethods").load(),console.log(o("paymentMethods").methods),await o("shippingZones").load(),console.log(o("shippingZones").zones)))()}
