var b=Object.defineProperty;var L=(r,e,t)=>e in r?b(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var p=(r,e,t)=>(L(r,typeof e!="symbol"?e+"":e,t),t);class O{constructor(){p(this,"content");this.content=[],this.load()}add(e,t=1,n){t=parseInt(t);const s=Alpine.store("products").findIndex(c=>c.id===e.id);let i;return n===void 0?i=this.content.findIndex(c=>c.pos===s):i=this.content.findIndex(c=>c.pos===s&&c.option===n),i!==-1?this.content[i].units+=t:this.content.push({pos:s,units:t,option:n}),this.save(),!0}get content(){return this.content}getUnits(e,t){let n=!1;const s=Alpine.store("products").findIndex(i=>i.id===e);if(s!==-1){let i=-1;t===void 0?i=this.content.findIndex(c=>c.pos===s):i=this.content.findIndex(c=>c.pos===s&&c.option===t),i!==-1?n=this.content[i].units:n=0}return n}remove(e,t){let n=!1,s=-1;return t===void 0||t===""?s=this.content.findIndex(i=>i.pos===e.pos):s=this.content.findIndex(i=>i.pos===e.pos&&i.option===t),s!==-1&&(this.content.splice(s,1),this.save(),n=!0),n}clear(){this.content=[],this.save()}save(){const n=new Date(new Date().getTime()+18144e5).toUTCString();document.cookie=`cart=${JSON.stringify(this.content)}; expires=${n}; max-age=${1814400*21};path=/; SameSite=Lax`}load(){try{if(document.cookie.split(";").some(t=>t.includes("cart"))){let t,n=document.cookie.split(";").find(i=>{if(i.startsWith("cart="))return t=!1,!0;if(i.startsWith(" cart="))return t=!0,!0});t?n=n.slice(6):n=n.slice(5);let s=JSON.parse(n);s=s.map(i=>({pos:i.pos,units:parseInt(i.units),option:i.option})),this.content=s}else this.save()}catch(e){this.save(),console.error(`Cart has been saved empty.
`,e)}}length(){return this.content.length}total(){let e=0;return this.content.forEach(t=>{const n=Alpine.store("products")[t.pos];e+=n.price*t.units}),e}}const B=class{constructor(e=[]){this.methods=e}get _methods(){return this.methods}set _methods(e=[]){this.methods=e}async load(){await fetch(B.api).then(e=>e.json()).then(e=>{this.methods=e})}getText(e){const t=e.percent;let n;return t===0?n=e.name:t<0?n=e.name+" ( "+t*-1+"% de descuento )":t>0&&(n=e.name+" ( "+t+"% de recargo )"),n}texts(){let e=[];for(let t=0;t<this.methods.length;t++)e[t]={name:this.getText(this.methods[t])};return e}applyPercent(e,t){const n=t.percent;let s;return n===0?s=e:s=e*(1+n/100),s}};let v=B;p(v,"api",location.origin+"/json/MetodosDePago.json");class P{static squareMeters(e,t){return e>=0?(e*t.m2ByUnit).toFixed(2):0}static productPage(e){let t=location.origin+"/"+e.name+"/"+e.id;return t=t.replace(/ /g,"-").toLowerCase(),t}static measurableInM2(e){return e.m2Price!=null&&e.m2ByUnit!=null}static addToCart(e=1,t,n){e=parseInt(e);let s=!1;return e>0?P.canBeAdded(e,t,n)?(n!==void 0?s=Alpine.store("cart").add(t,e,n):s=Alpine.store("cart").add(t,e),s?Alpine.store("Notify").Success("Agregado al carrito",1500):Alpine.store("Notify").Error("Ha ocurrido un error al agregar al carrito",2e3)):Alpine.store("Notify").Warning("No hay suficiente stock disponible."):Alpine.store("Notify").Warning("Debe agregar al menos una unidad",1500),s}static canBeAdded(e,t,n){let s=!0,i=0;return i=Alpine.store("cart").getUnits(t.id,n),s=this.validUnits(i+e,t,n),s}static validUnits(e,t,n){let s;const i=!(n===void 0||n===""||t.variationId===null);if(this.measurableInM2(t)){const c=t.m2ByUnit;if(!i)s=e*c<=t.units;else{const u=t.variationId,l=Alpine.store("variations").getByValue(u,n).units;s=e*c<=l}}else if(!i)s=e<=t.units;else{const c=t.variationId,u=Alpine.store("variations").getByValue(c,n).units;s=e<=u}return s}static maxAvailableUnits(e,t){let n;const s=t!==void 0&&t!=="";if(this.measurableInM2(e))if(s){const i=e.variationId,c=Alpine.store("variations").getByValue(i,t);n=parseFloat(c.units)/parseFloat(e.m2ByUnit)}else n=parseFloat(e.units)/parseFloat(e.m2ByUnit);else if(s){const i=e.variationId;n=Alpine.store("variations").getByValue(i,t).units}else n=e.units;return parseInt(n)}}const C=class{constructor(e=[]){this.zones=e}get _zones(){return this.zones}set _zones(e=[]){this.zones=e}async load(){await fetch(C.api).then(e=>e.json()).then(e=>{this.zones=e})}texts(){let e=[];for(let t=0;t<this.zones.length;t++)e[t]={name:this.zones[t].name+": $"+this.zones[t].cost};return e}};let y=C;p(y,"api",location.origin+"/json/ZonasDeEnvio.json");var x;(function(r){var e={soundsOff:!1,sounds:{success:"sounds/success, warning/1.mp3",warning:"sounds/success, warning/3.mp3",error:"sounds/errors/1.mp3"},animDuration:{success:4e3,warning:4e3,error:4e3}};Object.defineProperty(r,"Settings",{get:function(){return e},set:function(l){e.sounds=l.sounds||e.sounds,e.animDuration=l.animDuration||e.animDuration,e.soundsOff=l.soundsOff!=null?l.soundsOff:e.soundsOff}});function t(l,a){a===void 0&&(a=e.animDuration.error),u("error",l,a,c("error"))}r.Error=t;function n(l,a){a===void 0&&(a=e.animDuration.success),u("success",l,a,c("success"))}r.Success=n;function s(l,a){a===void 0&&(a=e.animDuration.warning),u("warning",l,a,c("warning"))}r.Warning=s;function i(l){l.classList.remove("active"),l.classList.remove("success"),l.classList.remove("error"),l.addEventListener("transitionend",function(a){var f=a.currentTarget.parentNode;a.propertyName!="bottom"||f==null||(setTimeout(function(){var d=f.getElementsByClassName("component-notify").length;d===0&&f.remove()},0),a.currentTarget.remove())})}r.Close=i;function c(l){var a=document.createElement("div");a.className="component-notify";var f=document.createElement("div");f.className="--text";var d=document.createElement("div");d.className="--button-close",d.addEventListener("click",function(g){g.stopPropagation();var I=g.target.closest(".component-notify");i(I)}),a.addEventListener("click",function(g){g.stopPropagation();var I=g.target.closest(".component-notify");i(I)}),d.innerHTML="<span>&#10006;</span>",a.appendChild(f),a.appendChild(d);var h=document.getElementById("notify-container");if(h||(h=document.createElement("div"),h.id="notify-container",document.body.appendChild(h)),e.soundsOff){var m=document.createElement("audio"),U=e.sounds[l];m.autoplay="autoplay",m.onended=function(){this.remove()},m.className="notify-sound",m.innerHTML='<source src="'+U+'" type="audio/mpeg" /><embed hidden="true" autostart="true" loop="false" src="'+U+'" />',h.appendChild(m)}return h.insertAdjacentElement("afterBegin",a),a}function u(l,a,f,d){a=a||"«ñîîáùåíèå íå ïåðåäàíî»",d.closest("#notify-container");var h=d.getElementsByClassName("--text")[0];h.textContent=a,setTimeout(function(){d.classList.add("active"),d.classList.add(l)},0),f&&setTimeout(function(){r.Close(d)},f)}})(x||(x={}));const S=x,A=class{constructor(){this.list=[]}async load(){await fetch(A.api).then(e=>e.json()).then(e=>{this.list=e,DEBUG&&console.log("Variaciones:",e)})}get(e){return this.list[e-1]}getValues(e){let t=[];return this.list[e-1].options.forEach(n=>{t.push(n.value)}),t}getByIndex(e){return this.list[e]}getByValue(e,t){const n=this.list.find((i,c)=>c===e-1);let s;return n!==void 0&&(s=n.options.find(i=>i.value===t)),s}texts(e){let t=[];const n=this.list[e-1].options;for(let s=0;s<n.length;s++)t[s]={name:n[s].value};return t}};let E=A;p(E,"api",location.origin+"/json/Variaciones.json");class M{constructor(){}total(){let e=0,t=Alpine.store("cart").total();const n=Alpine.store("selectedShippingZone");n!==void 0?e+=n.cost:console.log("Falta seleccionar la zona de envío.");const s=Alpine.store("selectedPaymentMethod");return s!==void 0?t=Alpine.store("paymentMethods").applyPercent(t,s):console.log("Falta seleccionar el método de pago."),e+=t,e}}const T=class{constructor(){this.reviews=[],this.show=[]}async load(){const e=await fetch(T.api);if(e.ok){const t=await e.json();this.reviews=t;for(let n=0;n<this.reviews.length;n++)this.show[n]=!1}else throw new Error(`Failed to load data from ${this.api}`)}run(){document.body.style.overflowX="hidden";let e=0;this.show[e]=!0,setInterval(()=>{this.show[e++]=!1,e==this.show.length&&(e=0),this.show[e]=!0},6e3)}};let w=T;p(w,"api",location.origin+"/api/google-reviews");DEBUG&&console.log("Code working");function o(r,e){if(e===void 0)return Alpine.store(r);Alpine.store(r,e)}function N(r){return"$"+new Intl.NumberFormat("de-DE").format(r)}function k(r){return new Intl.NumberFormat("de-DE").format(r)}function j(r,e){const t=document.getElementById("aux_black_transparent_bg"),n=document.getElementById("confirm_modal"),s=n.querySelector("p");s.innerText=r;const i=n.querySelector(".confirm_btn");i.innerText="Confirmar";var c=n.querySelector(".cancel_btn");c.innerText="Cancelar",t.classList.replace("hidden","fixed"),n.classList.replace("hidden","fixed"),o("ConfirmVisible",!0);function u(){n.classList.replace("fixed","hidden"),t.classList.replace("fixed","hidden"),c.removeEventListener("click",l),i.removeEventListener("click",a),setTimeout(()=>{o("ConfirmVisible",!1)},500)}function l(){u(),e(!1)}c.addEventListener("click",l);function a(){u(),e(!0)}i.addEventListener("click",a)}function F(r){console.log(o("cart").length()),o("cart").length()===0?o("Notify").Warning("Su carrito está vacío.",1250):location.href=r}document.addEventListener("alpine:init",async function(){o("products",[]),o("variations",new E),o("productsLength",0),o("sortedProducts",[]),o("productsToPrint",[]),o("printedProductsMax",!1),o("cart",new O),o("StaticProduct",P),o("Notify",S),o("cartOpened",!1),o("ConfirmVisible",!1),o("priceFormat",N),o("decimalFormat",k),o("Confirm",j),o("gotoCheckout",F),await z(),o("variations").load(),S.Settings={soundsOff:!1,animDuration:{success:3500,warning:3500,error:3500}};const r=window.location.pathname;r==="/"?D():r==="/checkout"?_():IS_PRODUCT_PAGE&&W()});function G(){const r=[];let e,t,n;o("products").forEach(s=>{e=s.category,t=r.findIndex(i=>i.category===e),t===-1?(n={category:e,products:[]},n.products.push(s),r.push(n)):r[t].products.push(s)}),o("sortedProducts",r)}function H(r){let e=[],t;r!==!1?o("sortedProducts").forEach(n=>{t={category:n.category,products:[]},t.products=n.products.slice(0,r),e.push(t)}):o("productsToPrint",o("sortedProducts")),DEBUG&&console.log("Products To Print:",e),o("productsToPrint",o("sortedProducts"))}async function z(){await fetch(location.origin+"/json/Productos.json").then(r=>r.json()).then(r=>{o("products",r),o("productsLength",r.length),DEBUG&&console.log("Productos sin ordenar:",o("products")),G(),o("sortedProducts",o("sortedProducts")),DEBUG&&console.log("Productos ordenados:",o("sortedProducts")),H(o("printedProductsMax"))})}async function D(){DEBUG&&console.log("THIS IS THE HOME PAGE."),o("googleReviews",new w),await o("googleReviews").load(),DEBUG&&console.log("REVIEWS: ",o("googleReviews").reviews)}async function _(){DEBUG&&console.log("THIS IS THE CHECKOUT PAGE."),o("selectedPaymentMethod",void 0),o("selectedShippingZone",void 0),o("paymentMethods",new v),o("shippingZones",new y),await o("paymentMethods").load(),DEBUG&&console.log("MÉTODOS DE PAGO: ",o("paymentMethods").methods),await o("shippingZones").load(),DEBUG&&console.log("ZONAS: ",o("shippingZones").zones),o("order",new M(o("cart"))),o("showSummary",()=>o("cart")!==void 0&&o("paymentMethods")!==void 0&&o("shippingZones")!==void 0)}function W(){DEBUG&&console.log("This is the Product Page!"),o("selectedVariation",void 0)}
