var U=Object.defineProperty;var S=(i,e,t)=>e in i?U(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var g=(i,e,t)=>(S(i,typeof e!="symbol"?e+"":e,t),t);class L{constructor(){g(this,"content");this.content=[],this.load()}add(e,t=1,n){t=parseInt(t);const o=Alpine.store("products").findIndex(l=>l.id===e.id);let c;return e.variationId!==null?c=this.content.findIndex(l=>l.pos===o&&l.option==n):c=this.content.findIndex(l=>l.pos===o),c!==-1?this.content[c].units+=t:this.content.push({pos:o,units:t,option:n}),this.save(),!0}get content(){return this.content}getUnits(e){let t=!1;const n=Alpine.store("products").findIndex(o=>o.id===e);if(n!==-1){const o=this.content.findIndex(c=>c.pos===n);o!==-1?t=this.content[o].units:t=0}return t}remove(e){let t=!1;const n=this.content.findIndex(o=>o.pos===e.pos);return n!==-1&&(this.content.splice(n,1),this.save(),t=!0),t}clear(){this.content=[],this.save()}save(){const n=new Date(new Date().getTime()+18144e5).toUTCString();console.log("expirationDate",n),console.log("days",1814400),document.cookie=`cart=${JSON.stringify(this.content)}; expires=${n}; max-age=${1814400*21};path=/; SameSite=Lax`}load(){try{if(document.cookie.split(";").some(t=>t.includes("cart"))){let t,n=document.cookie.split(";").find(c=>{if(c.startsWith("cart="))return t=!1,!0;if(c.startsWith(" cart="))return t=!0,!0});t?n=n.slice(6):n=n.slice(5);let o=JSON.parse(n);o=o.map(c=>({pos:c.pos,units:parseInt(c.units),option:c.option})),this.content=o}else this.save()}catch(e){this.save(),console.error(`Cart has been saved empty.
`,e)}}length(){return this.content.length}total(){let e=0;return this.content.forEach(t=>{const n=Alpine.store("products")[t.pos];e+=n.price*t.units}),e}}const I=class{constructor(e=[]){this.methods=e}get _methods(){return this.methods}set _methods(e=[]){this.methods=e}async load(){await fetch(I.api).then(e=>e.json()).then(e=>{this.methods=e})}getText(e){const t=e.percent;let n;return t===0?n=e.name:t<0?n=e.name+" ( "+t+"% de descuento )":t>0&&(n=e.name+" ( "+t+"% de recargo )"),n}texts(){let e=[];for(let t=0;t<this.methods.length;t++)e[t]={name:this.getText(this.methods[t])};return e}applyPercent(e,t){const n=t.percent;let o;return n===0?o=e:n<0?o=e*(1-n/100):n>0&&(o=e*(1+n/100)),o}};let y=I;g(y,"api",location.origin+"/json/MetodosDePago.json");class C{static squareMeters(e,t){return e>=0?(e*t.m2ByUnit).toFixed(2):0}static productPage(e){let t=location.origin+"/"+e.name+"/"+e.id;return t=t.replace(/ /g,"-").toLowerCase(),t}static measurableInM2(e){return e.m2Price!=null&&e.m2ByUnit!=null}static addToCart(e=1,t){e=parseInt(e);let n=!1;const o=Alpine.store("selectedVariation");return e>0?C.canBeAdded(e,t)?(t.variationId!==null?n=Alpine.store("cart").add(t,e,o):n=Alpine.store("cart").add(t,e),n?Alpine.store("Notify").Success("Agregado al carrito",1500):Alpine.store("Notify").Error("Ha ocurrido un error al agregar al carrito",2e3)):Alpine.store("Notify").Warning("No hay suficiente stock disponible."):Alpine.store("Notify").Warning("Debe agregar al menos una unidad",1500),n}static canBeAdded(e=1,t){let n=!0;const o=Alpine.store("cart").getUnits(t.id);return n=this.validUnits(o+e,t),n}static validUnits(e,t){let n;if(this.measurableInM2(t)){const o=t.m2ByUnit;n=e*o<=t.units}else n=e<=t.units;return n}static maxAvailableUnits(e,t){let n;return this.measurableInM2(e)?n=parseFloat(e.units)/parseFloat(e.m2ByUnit):n=e.units,parseInt(n)}}const T=class{constructor(e=[]){this.zones=e}get _zones(){return this.zones}set _zones(e=[]){this.zones=e}async load(){await fetch(T.api).then(e=>e.json()).then(e=>{this.zones=e})}texts(){let e=[];for(let t=0;t<this.zones.length;t++)e[t]={name:this.zones[t].name+": $"+this.zones[t].cost};return e}};let v=T;g(v,"api",location.origin+"/json/ZonasDeEnvio.json");var P;(function(i){var e={soundsOff:!1,sounds:{success:"sounds/success, warning/1.mp3",warning:"sounds/success, warning/3.mp3",error:"sounds/errors/1.mp3"},animDuration:{success:4e3,warning:4e3,error:4e3}};Object.defineProperty(i,"Settings",{get:function(){return e},set:function(a){e.sounds=a.sounds||e.sounds,e.animDuration=a.animDuration||e.animDuration,e.soundsOff=a.soundsOff!=null?a.soundsOff:e.soundsOff}});function t(a,r){r===void 0&&(r=e.animDuration.error),p("error",a,r,l("error"))}i.Error=t;function n(a,r){r===void 0&&(r=e.animDuration.success),p("success",a,r,l("success"))}i.Success=n;function o(a,r){r===void 0&&(r=e.animDuration.warning),p("warning",a,r,l("warning"))}i.Warning=o;function c(a){a.classList.remove("active"),a.classList.remove("success"),a.classList.remove("error"),a.addEventListener("transitionend",function(r){var u=r.currentTarget.parentNode;r.propertyName!="bottom"||u==null||(setTimeout(function(){var d=u.getElementsByClassName("component-notify").length;d===0&&u.remove()},0),r.currentTarget.remove())})}i.Close=c;function l(a){var r=document.createElement("div");r.className="component-notify";var u=document.createElement("div");u.className="--text";var d=document.createElement("div");d.className="--button-close",d.addEventListener("click",function(m){m.stopPropagation();var x=m.target.closest(".component-notify");c(x)}),r.addEventListener("click",function(m){m.stopPropagation();var x=m.target.closest(".component-notify");c(x)}),d.innerHTML="<span>&#10006;</span>",r.appendChild(u),r.appendChild(d);var f=document.getElementById("notify-container");if(f||(f=document.createElement("div"),f.id="notify-container",document.body.appendChild(f)),e.soundsOff){var h=document.createElement("audio"),B=e.sounds[a];h.autoplay="autoplay",h.onended=function(){this.remove()},h.className="notify-sound",h.innerHTML='<source src="'+B+'" type="audio/mpeg" /><embed hidden="true" autostart="true" loop="false" src="'+B+'" />',f.appendChild(h)}return f.insertAdjacentElement("afterBegin",r),r}function p(a,r,u,d){r=r||"«ñîîáùåíèå íå ïåðåäàíî»",d.closest("#notify-container");var f=d.getElementsByClassName("--text")[0];f.textContent=r,setTimeout(function(){d.classList.add("active"),d.classList.add(a)},0),u&&setTimeout(function(){i.Close(d)},u)}})(P||(P={}));const A=P,w=class{constructor(){this.list=[]}async load(){await fetch(w.api).then(e=>e.json()).then(e=>{this.list=e,DEBUG&&console.log("Variaciones:",e)})}get(e){return this.list[e-1]}getByIndex(e){return this.list[e]}getByName(e,t){const n=this.list.find((o,c)=>c===e-1).options.find(o=>o===t);console.log("optionData",n)}texts(e){let t=[];const n=this.list[e-1].options;for(let o=0;o<n.length;o++)t[o]={name:n[o]};return t}};let E=w;g(E,"api",location.origin+"/json/Variaciones.json");class O{constructor(){}total(){let e=0;const t=Alpine.store("cart").total();e+=t;const n=Alpine.store("selectedShippingZone");n!==void 0?e+=n.cost:console.log("Falta seleccionar la zona de envío.");const o=Alpine.store("selectedPaymentMethod");return o!==void 0?e=Alpine.store("paymentMethods").applyPercent(e,o):console.log("Falta seleccionar el método de pago."),e}}DEBUG&&console.log("Code working");function s(i,e){if(e===void 0)return Alpine.store(i);Alpine.store(i,e)}function b(i){return"$"+new Intl.NumberFormat("de-DE").format(i)}function M(i,e){const t=document.getElementById("aux_black_transparent_bg"),n=document.getElementById("confirm_modal"),o=n.querySelector("p");o.innerText=i;const c=n.querySelector(".confirm_btn");c.innerText="Confirmar";var l=n.querySelector(".cancel_btn");l.innerText="Cancelar",t.classList.replace("hidden","fixed"),n.classList.replace("hidden","fixed"),s("ConfirmVisible",!0);function p(){n.classList.replace("fixed","hidden"),t.classList.replace("fixed","hidden"),l.removeEventListener("click",a),c.removeEventListener("click",r),setTimeout(()=>{s("ConfirmVisible",!1)},500)}function a(){p(),e(!1)}l.addEventListener("click",a);function r(){p(),e(!0)}c.addEventListener("click",r)}function N(i){console.log(s("cart").length()),s("cart").length()===0?s("Notify").Warning("Su carrito está vacío.",1250):location.href=i}document.addEventListener("alpine:init",async function(){s("products",[]),s("variations",new E),s("productsLength",0),s("sortedProducts",[]),s("productsToPrint",[]),s("printedProductsMax",!1),s("cart",new L),s("StaticProduct",C),s("Notify",A),s("cartOpened",!1),s("ConfirmVisible",!1),s("priceFormat",b),s("Confirm",M),s("gotoCheckout",N),await j(),s("variations").load(),A.Settings={soundsOff:!1,animDuration:{success:3500,warning:3500,error:3500}};const i=window.location.pathname;i==="/"?D():i==="/checkout"?H():IS_PRODUCT_PAGE&&z()});function k(){const i=[];let e,t,n;s("products").forEach(o=>{e=o.category,t=i.findIndex(c=>c.category===e),t===-1?(n={category:e,products:[]},n.products.push(o),i.push(n)):i[t].products.push(o)}),s("sortedProducts",i)}function G(i){let e=[],t;i!==!1?s("sortedProducts").forEach(n=>{t={category:n.category,products:[]},t.products=n.products.slice(0,i),e.push(t)}):s("productsToPrint",s("sortedProducts")),DEBUG&&console.log("Products To Print:",e),s("productsToPrint",s("sortedProducts"))}async function j(){await fetch(location.origin+"/json/Productos.json").then(i=>i.json()).then(i=>{s("products",i),s("productsLength",i.length),DEBUG&&console.log("Productos sin ordenar:",s("products")),k(),s("sortedProducts",s("sortedProducts")),DEBUG&&console.log("Productos ordenados:",s("sortedProducts")),G(s("printedProductsMax"))})}function D(){DEBUG&&console.log("THIS IS THE HOME PAGE.")}async function H(){DEBUG&&console.log("THIS IS THE CHECKOUT PAGE."),s("selectedPaymentMethod",void 0),s("selectedShippingZone",void 0),s("paymentMethods",new y),s("shippingZones",new v),await s("paymentMethods").load(),DEBUG&&console.log("MÉTODOS DE PAGO: ",s("paymentMethods").methods),await s("shippingZones").load(),DEBUG&&console.log("ZONAS: ",s("shippingZones").zones),s("order",new O(s("cart"))),s("showSummary",()=>s("cart")!==void 0&&s("paymentMethods")!==void 0&&s("shippingZones")!==void 0)}function z(){DEBUG&&console.log("This is the Product Page!"),s("selectedVariation",void 0)}
