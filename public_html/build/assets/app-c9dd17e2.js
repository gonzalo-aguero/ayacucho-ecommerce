var S=Object.defineProperty;var A=(n,t,e)=>t in n?S(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var f=(n,t,e)=>(A(n,typeof t!="symbol"?t+"":t,e),e);class x{constructor(){f(this,"content");this.content=[],this.load()}add(t,e=1){e=parseInt(e);const r=Alpine.store("products").findIndex(u=>u.id===t.id),i=this.content.findIndex(u=>u.pos===r);return i!==-1?this.content[i].units+=e:this.content.push({pos:r,units:e}),this.save(),!0}get content(){return this.content}remove(t){let e=!1;const r=this.content.findIndex(i=>i.pos===t.pos);return r!==-1&&(this.content.splice(r,1),this.save(),e=!0),e}clear(){this.content=[],this.save()}save(){const r=new Date(new Date().getTime()+18144e5).toUTCString();document.cookie=`cart=${JSON.stringify(this.content)}; expires=date-in-GMTString-format=${r};`}load(){if(document.cookie.split(";").some(e=>e.includes("cart"))){const e=document.cookie.split(";").find(i=>i.startsWith("cart=")).slice(5);let r=JSON.parse(e);r=r.map(i=>({pos:i.pos,units:parseInt(i.units)})),this.content=r}else this.save()}length(){return this.content.length}total(){let t=0;return this.content.forEach(e=>{const r=Alpine.store("products")[e.pos];t+=r.price*e.units}),t}}const E=class{constructor(t=[]){this.methods=t}get _methods(){return this.methods}set _methods(t=[]){this.methods=t}async load(){await fetch(E.api).then(t=>t.json()).then(t=>{this.methods=t})}};let m=E;f(m,"api","./json/MetodosDePago.json");class I{static squareMeters(t,e){return t>=0?(t*e.m2ByUnit).toPrecision(3):0}static productPage(t){let e="producto/"+t.name+"/"+t.id;return e=e.replace(/ /g,"-").toLowerCase(),e}static measurableInM2(t){return t.m2Price!=null&&t.m2ByUnit!=null}static addToCart({units:t},e){Alpine.store("cart").add(e,t)?(Alpine.store("Notify").Success("Agregado al carrito",1500),t=1):Alpine.store("Notify").Error("Ha ocurrido un error al agregar al carrito",2e3)}}const y=class{constructor(t=[]){this.zones=t}get _zones(){return this.zones}set _zones(t=[]){this.zones=t}async load(){await fetch(y.api).then(t=>t.json()).then(t=>{this.zones=t})}selectorTexts(){let t=[];for(let e=0;e<this.zones.length;e++)t[e]={name:this.zones[e].name+": $"+this.zones[e].cost};return t}};let h=y;f(h,"api","./json/ZonasDeEnvio.json");var P;(function(n){var t={soundsOff:!1,sounds:{success:"sounds/success, warning/1.mp3",warning:"sounds/success, warning/3.mp3",error:"sounds/errors/1.mp3"},animDuration:{success:4e3,warning:4e3,error:4e3}};Object.defineProperty(n,"Settings",{get:function(){return t},set:function(c){t.sounds=c.sounds||t.sounds,t.animDuration=c.animDuration||t.animDuration,t.soundsOff=c.soundsOff!=null?c.soundsOff:t.soundsOff}});function e(c,o){o===void 0&&(o=t.animDuration.error),v("error",c,o,g("error"))}n.Error=e;function r(c,o){o===void 0&&(o=t.animDuration.success),v("success",c,o,g("success"))}n.Success=r;function i(c,o){o===void 0&&(o=t.animDuration.warning),v("warning",c,o,g("warning"))}n.Warning=i;function u(c){c.classList.remove("active"),c.classList.remove("success"),c.classList.remove("error"),c.addEventListener("transitionend",function(o){var d=o.currentTarget.parentNode;o.propertyName!="bottom"||d==null||(setTimeout(function(){var a=d.getElementsByClassName("component-notify").length;a===0&&d.remove()},0),o.currentTarget.remove())})}n.Close=u;function g(c){var o=document.createElement("div");o.className="component-notify";var d=document.createElement("div");d.className="--text";var a=document.createElement("div");a.className="--button-close",a.addEventListener("click",function(C){C.stopPropagation();var O=C.target.closest(".component-notify");u(O)}),a.innerHTML="<span>&#10006;</span>",o.appendChild(d),o.appendChild(a);var l=document.getElementById("notify-container");if(l||(l=document.createElement("div"),l.id="notify-container",document.body.appendChild(l)),t.soundsOff){var p=document.createElement("audio"),w=t.sounds[c];p.autoplay="autoplay",p.onended=function(){this.remove()},p.className="notify-sound",p.innerHTML='<source src="'+w+'" type="audio/mpeg" /><embed hidden="true" autostart="true" loop="false" src="'+w+'" />',l.appendChild(p)}return l.insertAdjacentElement("afterBegin",o),o}function v(c,o,d,a){o=o||"«ñîîáùåíèå íå ïåðåäàíî»",a.closest("#notify-container");var l=a.getElementsByClassName("--text")[0];l.textContent=o,setTimeout(function(){a.classList.add("active"),a.classList.add(c)},0),d&&setTimeout(function(){n.Close(a)},d)}})(P||(P={}));const T=P;DEBUG&&console.log("Code working");function s(n,t){if(t===void 0)return Alpine.store(n);Alpine.store(n,t)}document.addEventListener("alpine:init",async function(){switch(s("products",[]),s("productsLength",0),s("sortedProducts",[]),s("productsToPrint",[]),s("printedProductsMax",!1),s("cart",new x),s("StaticProduct",I),s("Notify",T),s("cartOpened",!1),s("priceFormat",B),s("Confirm",M),await N(),console.log("PRODUCTOS CARGADOS 2"),T.Settings={soundsOff:!1,animDuration:{success:5e3,warning:5e3,error:5e3}},window.location.pathname){case"/":j();break;case"/checkout":H();break}});function D(){const n=[];let t,e,r;s("products").forEach(i=>{t=i.category,e=n.findIndex(u=>u.category===t),e===-1?(r={category:t,products:[]},r.products.push(i),n.push(r)):n[e].products.push(i)}),s("sortedProducts",n)}function L(n){let t=[],e;n!==!1?s("sortedProducts").forEach(r=>{e={category:r.category,products:[]},e.products=r.products.slice(0,n),t.push(e)}):s("productsToPrint",s("sortedProducts")),DEBUG&&console.log("Products To Print:",t),s("productsToPrint",s("sortedProducts"))}async function N(){await fetch("json/Productos.json").then(n=>n.json()).then(n=>{s("products",n),s("productsLength",n.length),DEBUG&&console.log("Productos sin ordenar:",s("products")),D(),s("sortedProducts",s("sortedProducts")),DEBUG&&console.log("Productos ordenados:",s("sortedProducts")),L(s("printedProductsMax")),console.log("PRODUCTOS CARGADOS")})}function B(n){return"$"+new Intl.NumberFormat("de-DE").format(n)}function M(n){return confirm(n)}function j(){console.log("THIS IS THE HOME PAGE.")}async function H(){console.log("THIS IS THE CHECKOUT PAGE."),s("paymentMethodSelected",void 0),s("shippingZoneSelected",void 0),s("paymentMethods",new m),s("shippingZones",new h),await s("paymentMethods").load(),console.log(s("paymentMethods").methods),await s("shippingZones").load(),console.log("ZONAS:",s("shippingZones").zones)}
